<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <title>Apoie Produtores Locais</title>

    <link href="https://fonts.googleapis.com/css?family=Merienda+One|Open+Sans&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
        }

        h2,
        .v-toolbar__title {
            font-family: 'Merienda One', cursive;
            margin-bottom: 5px;
        }

        a,
        a>* {
            color: #7E57C2 !important;
            text-decoration: none !important;
        }
    </style>

    {% if PROD %}
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-7792152-10"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-7792152-10');
    </script>
    {% endif %}
</head>

{% comment %}
lime lighten-2
lime lighten-5
lime darken-3
deep-purple lighten-1
{% endcomment %}

<body>
    <v-app id="app" style="background-color: #F9FBE7;">
        <v-app-bar app color="lime darken-3" dark elevate-on-scroll>
            <v-app-bar-nav-icon @click.stop="drawer = !drawer"></v-app-bar-nav-icon>
            <v-toolbar-title>Apoie Produtores Locais</v-toolbar-title>
        </v-app-bar>

        <v-navigation-drawer app v-model="drawer" temporary color="lime lighten-2">

            <v-list>
                {% if request.user.is_authenticated %}
                <v-list-item>
                    <v-list-item-content>
                        <v-list-item-title class="title">
                            {{ request.user.username }}
                        </v-list-item-title>
                    </v-list-item-content>
                </v-list-item>

                <v-divider></v-divider>
                {% endif %}

                <v-list-item-group v-model="estadoDrawer">
                    {% if request.user.is_authenticated %}
                    <v-list-item link href="{% url 'account_logout' %}?next={{request.path}}">
                        <v-list-item-action>
                            <v-icon>mdi-logout</v-icon>
                        </v-list-item-action>
                        <v-list-item-content>
                            <v-list-item-title>Sair</v-list-item-title>
                        </v-list-item-content>
                    </v-list-item>
                    {% else %}
                    <v-list-item link href="{% url 'account_login' %}?next={{request.path}}">
                        <v-list-item-action>
                            <v-icon>mdi-login</v-icon>
                        </v-list-item-action>
                        <v-list-item-content>
                            <v-list-item-title>Login</v-list-item-title>
                        </v-list-item-content>
                    </v-list-item>
                    {% endif %}
                    <v-list-item :value="estadoAtual !== estadoAdministrar" @click="irParaPesquisa()">
                        <v-list-item-action>
                            <v-icon>mdi-magnify</v-icon>
                        </v-list-item-action>
                        <v-list-item-content>
                            <v-list-item-title>
                                Pesquisar
                            </v-list-item-title>
                        </v-list-item-content>
                    </v-list-item>
                    {% if request.user.is_authenticated %}
                    <v-list-item :value="estadoAtual === estadoAdministrar" @click="irParaAdministracao()">
                        <v-list-item-action>
                            <v-icon>mdi-account-details</v-icon>
                        </v-list-item-action>
                        <v-list-item-content>
                            <v-list-item-title>Administrar negócio</v-list-item-title>
                        </v-list-item-content>
                    </v-list-item>
                    {% endif %}
                </v-list-item-group>
            </v-list>
        </v-navigation-drawer>

        <v-content>
            <v-container fluid>
                <v-overlay :value="loading.length > 0" style="z-index: 3000">
                    <v-layout row justify-center align-center>
                        <v-progress-circular indeterminate :size="128" :width="8" color="deep-purple lighten-1">
                        </v-progress-circular>
                    </v-layout>
                </v-overlay>
                <v-row class="mx-0" v-if="estadoAtual === estadoLista">
                    <v-col cols="12" offset-md="1" md="10" class="text-center">
                        <v-sheet color="lime lighten-2" tile>
                            <v-sheet color="lime lighten-2" class="pa-3" tile>
                                <span class="mb-0 font-italic">O momento que estamos passando no
                                    Brasil é difícil para
                                    todos. Os
                                    pequenos negócios
                                    sofrerão ainda mais do que as grandes indústrias. Por isso, cada um tem
                                    feito o
                                    que
                                    pode
                                    para se manter.</span>
                                <span class="mb-0 font-italic">Este site foi criado com o intuito de listar e
                                    centralizar as
                                    informações de serviços e pequenos negócios do DF que estão funcionando com
                                    delivery
                                    ou take out
                                    (retirada no local).</span>
                                <span class="mb-0 font-italic">Para cadastrar seu negócio/produto, crie uma conta para
                                    adicionar
                                    as
                                    informações!</span>
                            </v-sheet>
                        </v-sheet>
                    </v-col>
                </v-row>
                <v-row class="mx-0">
                    <!-- <v-col cols="12" md="6" v-if="estadoAtual === estadoLista">
                        <v-sheet color="lime lighten-2" tile>
                            <v-sheet color="lime lighten-2" class="pa-3" tile>
                                <h2>Sobre</h2>
                                <p>A ideia dessa página é centralizar as informações de pequenos produtores no DF.</p>
                                <p class="mb-0">Dessa forma podemos padronizar as listas que tem circulado
                                    pelas redes sociais.</p>
                                <p class="mb-0">Caso você seja o dono de algum dos negócios já cadastrados,
                                    crie sua conta e envie um email para
                                    <a href="javascript:;">apoieprodutoreslocais@gmail.com</a>,
                                    para vincular as informações a sua conta.
                                </p>
                            </v-sheet>

                            <v-col cols=" 12" class="hidden-sm-and-down">
                                <v-divider></v-divider>
                            </v-col>

                            <v-sheet class="pa-3 hidden-sm-and-down" color="lime lighten-2" tile>
                                <h2>Filtros</h2>
                                <v-row>
                                    <v-col md="4">
                                        <v-select v-model="pesquisa.categoria" :items="categorias" item-text="nome"
                                            item-value="id" label="Categoria" outlined>
                                        </v-select>
                                    </v-col>
                                    <v-col md="4">
                                        <v-text-field v-model="pesquisa.nome" label="Nome" placeholder="Digite um nome"
                                            outlined>
                                        </v-text-field>
                                    </v-col>
                                    <v-col md="4">
                                        <v-select v-model="pesquisa.regiaoEntrega" :items="regioesEntrega"
                                            item-text="nome" item-value="id" label="Região de entrega" outlined>
                                        </v-select>
                                    </v-col>
                                </v-row>
                            </v-sheet>
                    </v-col> -->

                    <v-col cols="12" class="hidden-md-and-up" v-if="estadoAtual === estadoLista">
                        <v-divider></v-divider>
                    </v-col>

                    <v-col cols="12" md="6" v-if="estadoAtual === estadoLista">
                        <v-sheet color="lime lighten-2" tile>
                            <v-sheet color="lime lighten-2" class="pa-3" tile>
                                <v-btn class="mr-5 hidden-md-and-up" icon @click="showFiltros = !showFiltros" right
                                    absolute color="deep-purple lighten-1">
                                    <v-icon large>[[ showFiltros ? 'mdi-chevron-up' : 'mdi-chevron-down' ]]
                                    </v-icon>
                                </v-btn>
                                <h2>Filtros</h2>
                                <v-row v-if="showFiltros">
                                    <v-col cols="12">
                                        <v-select v-model="pesquisa.categoria" :items="categorias" item-text="nome"
                                            item-value="id" label="Categoria" outlined>
                                        </v-select>
                                    </v-col>
                                    <v-col cols="12">
                                        <v-text-field v-model="pesquisa.nome" label="Nome" placeholder="Digite um nome"
                                            outlined>
                                        </v-text-field>
                                    </v-col>
                                    <v-col cols="12">
                                        <v-select v-model="pesquisa.regiaoEntrega" :items="regioesEntrega"
                                            item-text="nome" item-value="id" label="Região de entrega" outlined>
                                        </v-select>
                                    </v-col>
                                </v-row>
                            </v-sheet>
                        </v-sheet>
                    </v-col>

                    <v-col cols="12" class="hidden-md-and-up" v-if="estadoAtual === estadoLista">
                        <v-divider></v-divider>
                    </v-col>

                    <v-col cols="12" md="6" v-if="estadoAtual === estadoLista">
                        <v-sheet color="lime lighten-2" tile>
                            <v-sheet color="lime lighten-2" class="pa-3" tile>
                                <h2>Negócios</h2>
                                <v-card>
                                    <v-list class="py-0" color="lime lighten-5" two-line max-height="600"
                                        style="overflow-y: scroll;">
                                        <v-list-item-group v-if="negociosFiltrados.length !== 0"
                                            active-class="deep-purple--text text--lighten-1">
                                            <template v-for="(negocio, index) in negociosFiltrados">
                                                <v-list-item @click="selecionarNegocio(negocio)">
                                                    <template v-slot:default="{ active, toggle }">
                                                        <v-list-item-content>
                                                            <v-list-item-title>
                                                                <span>[[ negocio.nome ]]</span>
                                                                <span v-if="negocio.instagram.length > 0">
                                                                    <a v-on:click.stop target="_blank"
                                                                        :href="formatarUrlInstagram(negocio.instagram)">
                                                                        <v-icon>mdi-instagram</v-icon>
                                                                    </a>
                                                                </span>
                                                            </v-list-item-title>

                                                            <v-list-item-subtitle v-if="negocio.categorias">
                                                                <v-tooltip bottom
                                                                    v-for="(categoriaNegocio, index) in negocio.categorias">
                                                                    <template v-slot:activator="{ on }">
                                                                        <v-icon v-on:click.stop v-on="on">
                                                                            [[
                                                                            buscarCategoriaIcone(categoriaNegocio.categoria)
                                                                            ]]
                                                                        </v-icon>
                                                                    </template>
                                                                    <span>[[
                                                                        buscarCategoriaNome(categoriaNegocio.categoria)
                                                                        ]]</span>
                                                                </v-tooltip>
                                                            </v-list-item-subtitle>
                                                            <v-list-item-subtitle class="text--primary"
                                                                v-text="negocio.endereco">
                                                            </v-list-item-subtitle>

                                                            <template
                                                                v-for="(contato, indexContato) in negocio.contatos">
                                                                <v-list-item-subtitle>
                                                                    <span>
                                                                        <span>[[ contato.nome_telefone ]]
                                                                            <a v-on:click.stop v-if="contato.whatsapp"
                                                                                :href="contato.whatsapp"
                                                                                target="_blank">
                                                                                <v-icon>mdi-whatsapp</v-icon>
                                                                            </a></span>
                                                                    </span>
                                                                </v-list-item-subtitle>
                                                            </template>
                                                        </v-list-item-content>
                                                    </template>
                                                </v-list-item>
                                                <v-divider v-if="index + 1 < negociosFiltrados.length" :key="index">
                                                </v-divider>
                                            </template>
                                        </v-list-item-group>

                                        <v-list-item v-if="negociosFiltrados.length === 0">
                                            <v-list-item-content>
                                                <v-list-item-subtitle style="white-space: normal;">
                                                    <span>
                                                        Não foram encontrados resultados para os filtros
                                                        selecionados</span>
                                                </v-list-item-subtitle>
                                            </v-list-item-content>
                                        </v-list-item>
                                    </v-list>
                                </v-card>
                            </v-sheet>
                            <v-sheet color="lime lighten-2" class="pa-3 text-center" tile>
                                <h4>Conhece algum negócio que poderia estar listado aqui? Divulgue o site
                                    e peça para se cadastrarem!</h4>
                            </v-sheet>
                        </v-sheet>
                    </v-col>

                    <v-col cols="12" v-if="estadoAtual === estadoDetalhe">
                        <v-sheet color="lime lighten-2" tile>
                            <v-sheet color="lime lighten-2" class="pa-3" tile>
                                <v-row>
                                    <v-col cols="12" class="py-0">
                                        <h2>[[ negocioSelecionado.nome ]]
                                            <span v-if="negocioSelecionado.instagram.length > 0">
                                                <a :href="formatarUrlInstagram(negocioSelecionado.instagram)"
                                                    target="_blank">
                                                    <v-icon large>mdi-instagram</v-icon>
                                                </a>
                                            </span>
                                        </h2>
                                    </v-col>
                                    <v-col cols="12" class="py-0">
                                        <h4>
                                            <v-tooltip bottom
                                                v-for="(categoriaNegocio, index) in negocioSelecionado.categorias">
                                                <template v-slot:activator="{ on }">
                                                    <v-icon v-on="on">
                                                        [[
                                                        buscarCategoriaIcone(categoriaNegocio.categoria)
                                                        ]]
                                                    </v-icon>
                                                </template>
                                                <span>[[ buscarCategoriaNome(categoriaNegocio.categoria)
                                                    ]]</span>
                                            </v-tooltip>
                                        </h4>
                                    </v-col>
                                    <v-col cols="12" class="py-0">
                                        <h4>[[negocioSelecionado.endereco]]</h4>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Contatos</h4>
                                        <v-col cols="12" class="pa-0"
                                            v-for="(contato, indexContato) in negocioSelecionado.contatos">
                                            <span>[[ contato.nome_telefone ]]
                                                <a v-if="contato.whatsapp" :href="contato.whatsapp" target="_blank">
                                                    <v-icon>mdi-whatsapp</v-icon>
                                                </a>
                                            </span>
                                        </v-col>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Formas de pagamento</h4>
                                        <span>[[ negocioSelecionado.formas_pagamento ]]</span>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Formas de entrega</h4>
                                        <span>[[ formatarFormaEntrega(negocioSelecionado.formas_entrega)
                                            ]]</span>
                                    </v-col>

                                    <v-col v-if="negocioSelecionado.valor_minimo > 0" cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">
                                            Valor mínimo do pedido
                                        </h4>
                                        <span>[[ formatarPreco(negocioSelecionado.valor_minimo)
                                            ]]</span>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Regiões de entrega</h4>
                                        <v-col cols="12" class="pa-0"
                                            v-for="(regiaoEntrega, indexRegiaoEntrega) in negocioSelecionado.regioes_entrega">
                                            <v-row>
                                                <v-col cols="8" class="py-0">
                                                    <span>
                                                        [[ regiaoEntrega.nomeRegiao ]]
                                                    </span>
                                                </v-col>
                                                <v-col cols="4" class="py-0 pl-0">
                                                    <span v-if="regiaoEntrega.taxa_entrega > 0"
                                                        class="float-right font-weight-bold">[[
                                                        formatarPreco(regiaoEntrega.taxa_entrega)
                                                        ]]</span>
                                                </v-col>
                                            </v-row>
                                        </v-col>
                                    </v-col>

                                    <v-col cols="12" md="4" class="py-0">
                                        <h4 class="mt-2">Produtos</h4>
                                        <v-col cols="12" class="pa-0"
                                            v-for="(produto, indexProduto) in negocioSelecionado.produtos">
                                            <v-row>
                                                <v-col cols="8" class="py-0">
                                                    <span>
                                                        <v-icon>[[ buscarCategoriaIcone(produto.categoria) ]]
                                                        </v-icon>
                                                        [[ produto.nome ]]
                                                    </span>
                                                </v-col>
                                                <v-col cols="4" class="py-0 pl-0">
                                                    <span v-if="produto.preco > 0"
                                                        class="float-right font-weight-bold">[[
                                                        formatarPreco(produto.preco)
                                                        ]]</span>
                                                </v-col>
                                            </v-row>
                                        </v-col>
                                    </v-col>
                                </v-row>
                            </v-sheet>
                        </v-sheet>
                        <v-btn fab color="deep-purple lighten-1" bottom right fixed @click="voltarLista()">
                            <v-icon color="white">mdi-arrow-left</v-icon>
                        </v-btn>
                    </v-col>
                </v-row>

                {% comment %}
                Modais de formulário
                {% endcomment %}
                {% if request.user.is_authenticated %}
                <v-row class="mx-0" v-if="estadoAtual === estadoAdministrar">
                    <v-col cols="12">
                        <v-sheet color="lime lighten-2" tile>
                            <v-sheet color="lime lighten-2" class="pa-3" tile>

                                <v-btn color="deep-purple lighten-1" text
                                    @click="mostrarModalForm('negocio', null, false)" v-if="meuNegocio === null">
                                    <v-icon>mdi-plus</v-icon> Novo negócio
                                </v-btn>

                                <v-row v-if="meuNegocio !== null">
                                    <v-col cols="12" class="py-0">
                                        <h2>[[ meuNegocio.nome ]]
                                            <span v-if="meuNegocio.instagram.length > 0">
                                                <a :href="formatarUrlInstagram(meuNegocio.instagram)" target="_blank">
                                                    <v-icon large>mdi-instagram</v-icon>
                                                </a>
                                            </span>
                                            <v-btn color="deep-purple lighten-1" text
                                                @click="mostrarModalForm('negocio', meuNegocio, false)">
                                                <v-icon>mdi-pencil</v-icon>
                                            </v-btn>
                                        </h2>
                                    </v-col>
                                    <v-col cols="12" class="py-0">
                                        <h4>
                                            <span v-for="(categoriaNegocio, index) in meuNegocio.categorias">
                                                <v-menu open-on-click bottom offset-y>
                                                    <template v-slot:activator="{ on }">
                                                        <a v-on="on">
                                                            <v-icon>
                                                                [[
                                                                buscarCategoriaIcone(categoriaNegocio.categoria)
                                                                ]]
                                                            </v-icon>
                                                        </a>
                                                    </template>

                                                    <v-list color="lime lighten-5">
                                                        <v-list-item>
                                                            <v-btn color="deep-purple lighten-1" text
                                                                @click="mostrarModalForm('categoria', categoriaNegocio, false)">
                                                                <v-icon>mdi-pencil</v-icon> Editar
                                                            </v-btn>
                                                        </v-list-item>
                                                        <v-list-item>
                                                            <v-btn color="deep-purple lighten-1" text
                                                                @click="mostrarModalForm('categoria', categoriaNegocio, true)">
                                                                <v-icon>mdi-delete</v-icon> Excluir
                                                            </v-btn>
                                                        </v-list-item>
                                                    </v-list>
                                                </v-menu>
                                            </span>

                                            <v-btn color="deep-purple lighten-1" text
                                                @click="mostrarModalForm('categoria', null, false)">
                                                <v-icon>mdi-plus</v-icon>
                                            </v-btn>
                                        </h4>
                                    </v-col>
                                    <v-col cols="12" class="py-0">
                                        <h4>[[meuNegocio.endereco]]</h4>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Contatos
                                            <v-btn color="deep-purple lighten-1" text
                                                @click="mostrarModalForm('contato', null, false)">
                                                <v-icon>mdi-plus</v-icon>
                                            </v-btn>
                                        </h4>
                                        <v-col cols="12" class="pa-0"
                                            v-for="(contato, indexContato) in meuNegocio.contatos">
                                            <v-menu open-on-click bottom offset-y>
                                                <template v-slot:activator="{ on }">
                                                    <span><a v-on="on">[[ contato.nome_telefone ]]</a>
                                                        <a v-if="contato.whatsapp" :href="contato.whatsapp"
                                                            target="_blank">
                                                            <v-icon>mdi-whatsapp</v-icon>
                                                        </a>
                                                    </span>
                                                </template>

                                                <v-list color="lime lighten-5">
                                                    <v-list-item>
                                                        <v-btn color="deep-purple lighten-1" text
                                                            @click="mostrarModalForm('contato', contato, false)">
                                                            <v-icon>mdi-pencil</v-icon> Editar
                                                        </v-btn>
                                                    </v-list-item>
                                                    <v-list-item>
                                                        <v-btn color="deep-purple lighten-1" text
                                                            @click="mostrarModalForm('contato', contato, true)">
                                                            <v-icon>mdi-delete</v-icon> Excluir
                                                        </v-btn>
                                                    </v-list-item>
                                                </v-list>
                                            </v-menu>
                                        </v-col>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Formas de pagamento</h4>
                                        <span>[[ meuNegocio.formas_pagamento ]]</span>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Formas de entrega</h4>
                                        <span>[[ formatarFormaEntrega(meuNegocio.formas_entrega)
                                            ]]</span>
                                    </v-col>

                                    <v-col v-if="meuNegocio.valor_minimo > 0" cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">
                                            Valor mínimo do pedido
                                        </h4>
                                        <span>[[ formatarPreco(meuNegocio.valor_minimo)
                                            ]]</span>
                                    </v-col>

                                    <v-col cols="12" md="3" class="py-0">
                                        <h4 class="mt-2">Regiões de entrega
                                            <v-btn color="deep-purple lighten-1" text
                                                @click="mostrarModalForm('regiao-entrega', null, false)">
                                                <v-icon>mdi-plus</v-icon>
                                            </v-btn>
                                        </h4>
                                        <v-col cols="12" class="pa-0"
                                            v-for="(regiaoEntrega, indexRegiaoEntrega) in meuNegocio.regioes_entrega">
                                            <v-menu open-on-click bottom offset-y>
                                                <template v-slot:activator="{ on }">
                                                    <v-row>
                                                        <v-col cols="8" class="py-0">
                                                            <span><a v-on="on">
                                                                    [[ regiaoEntrega.nomeRegiao ]]
                                                                </a> </span>
                                                        </v-col>
                                                        <v-col cols="4" class="py-0 pl-0">
                                                            <span v-if="regiaoEntrega.taxa_entrega > 0"
                                                                class="float-right font-weight-bold">[[
                                                                formatarPreco(regiaoEntrega.taxa_entrega)
                                                                ]]</span>
                                                        </v-col>
                                                    </v-row>
                                                </template>

                                                <v-list color="lime lighten-5">
                                                    <v-list-item>
                                                        <v-btn color="deep-purple lighten-1" text
                                                            @click="mostrarModalForm('regiao-entrega', regiaoEntrega, false)">
                                                            <v-icon>mdi-pencil</v-icon> Editar
                                                        </v-btn>
                                                    </v-list-item>
                                                    <v-list-item>
                                                        <v-btn color="deep-purple lighten-1" text
                                                            @click="mostrarModalForm('regiao-entrega', regiaoEntrega, true)">
                                                            <v-icon>mdi-delete</v-icon> Excluir
                                                        </v-btn>
                                                    </v-list-item>
                                                </v-list>
                                            </v-menu>
                                        </v-col>
                                    </v-col>

                                    <v-col cols="12" md="4" class="py-0">
                                        <h4 class="mt-2">Produtos
                                            <v-btn color="deep-purple lighten-1" text
                                                @click="mostrarModalForm('produto', null, false)">
                                                <v-icon>mdi-plus</v-icon>
                                            </v-btn>
                                        </h4>
                                        <v-col cols="12" class="pa-0"
                                            v-for="(produto, indexProduto) in meuNegocio.produtos">
                                            <v-menu open-on-click bottom offset-y>
                                                <template v-slot:activator="{ on }">
                                                    <v-row>
                                                        <v-col cols="8" class="py-0">
                                                            <span><a v-on="on">
                                                                    <v-icon>[[
                                                                        buscarCategoriaIcone(produto.categoria)
                                                                        ]]
                                                                    </v-icon>
                                                                    [[ produto.nome ]]
                                                                </a>
                                                            </span>
                                                        </v-col>
                                                        <v-col cols="4" class="py-0 pl-0">
                                                            <span v-if="produto.preco > 0"
                                                                class="float-right font-weight-bold">[[
                                                                formatarPreco(produto.preco)
                                                                ]]</span>
                                                        </v-col>
                                                    </v-row>
                                                </template>

                                                <v-list color="lime lighten-5">
                                                    <v-list-item>
                                                        <v-btn color="deep-purple lighten-1" text
                                                            @click="mostrarModalForm('produto', produto, false)">
                                                            <v-icon>mdi-pencil</v-icon> Editar
                                                        </v-btn>
                                                    </v-list-item>
                                                    <v-list-item>
                                                        <v-btn color="deep-purple lighten-1" text
                                                            @click="mostrarModalForm('produto', produto, true)">
                                                            <v-icon>mdi-delete</v-icon> Excluir
                                                        </v-btn>
                                                    </v-list-item>
                                                </v-list>
                                            </v-menu>
                                        </v-col>
                                    </v-col>
                                </v-row>
                            </v-sheet>
                        </v-sheet>
                    </v-col>
                </v-row>

                <v-dialog v-model="modal.show" persistent max-width="90%">
                    <v-card>
                        <v-form :method="[[ modal.method ]]" :action="[[ modal.url ]]" ref="form"
                            @submit.prevent="enviarForm" v-model="modal.formValido">
                            {% csrf_token %}
                            <v-card-title>
                                <span class="headline">[[ modal.headline ]]</span>
                            </v-card-title>
                            <v-card-text>
                                <small>* indica campo obrigatório</small>
                                <v-container>
                                    <v-row v-if="modal.estadoAtual === modal.estadoAlteracaoNegocio">
                                        <v-col cols="12" sm="6" md="4">
                                            <v-text-field outlined label="Nome*"
                                                :rules="[v => !!v || 'Campo obrigatório']" name="nome"
                                                :disabled="modal.method === 'DELETE'" :error-messages="modal.erros.nome"
                                                hint="Nome do negócio" v-model="modal.form.nome">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6">
                                            <v-select outlined
                                                :items="[{value: 1, text: 'Delivery'}, {value: 2, text: 'Take Out'}, {value: 3, text: 'Delivery e Take Out'}]"
                                                :error-messages="modal.erros.formas_entrega" label="Formas de entrega*"
                                                name="formas_entrega" :disabled="modal.method === 'DELETE'"
                                                :rules="[v => !!v || 'Campo obrigatório']"
                                                v-model="modal.form.formas_entrega">
                                            </v-select>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <input type="hidden" name="valor_minimo"
                                                v-model="modal.form.valor_minimo" />
                                            <v-text-field outlined label="Valor mínimo" v-model="valor_minimoFormatado"
                                                :error-messages="modal.erros.valor_minimo"
                                                hint="Valor mínimo para realizar pedido" prefix="R$"
                                                :disabled="modal.method === 'DELETE'">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols=" 12" sm="6">
                                            <v-text-field outlined label="Formas de pagamento*"
                                                :rules="[v => !!v || 'Campo obrigatório']" name="formas_pagamento"
                                                :error-messages="modal.erros.formas_pagamento"
                                                hint="Transferências, cartão de crédito/débito e outros"
                                                :disabled="modal.method === 'DELETE'"
                                                v-model="modal.form.formas_pagamento">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <v-text-field outlined label="Endereço" name="endereco"
                                                :error-messages="modal.erros.endereco"
                                                hint="Endereço do negócio, se houver"
                                                :disabled="modal.method === 'DELETE'" v-model="modal.form.endereco">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <input type="hidden" name="taxa_padrao_entrega"
                                                v-model="modal.form.taxa_padrao_entrega" />
                                            <v-text-field outlined label="Taxa padrão de entrega" prefix="R$"
                                                :error-messages="modal.erros.taxa_padrao_entrega"
                                                hint="Taxa padrão que irá aparecer ao definir regiões para entrega"
                                                :disabled="modal.method === 'DELETE'"
                                                v-model="taxa_padrao_entregaFormatada">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <v-text-field outlined label="Instagram" name="instagram"
                                                hint="Perfil no Instagram" :error-messages="modal.erros.instagram"
                                                :disabled="modal.method === 'DELETE'" v-model="modal.form.instagram">
                                            </v-text-field>
                                        </v-col>
                                    </v-row>
                                    <v-row v-if="modal.estadoAtual === modal.estadoAlteracaoCategoria">
                                        <input type="hidden" name="negocio" :value="meuNegocio.id" />
                                        <v-col cols="12" sm="6" md="4">
                                            <v-select outlined :items="categorias.slice(1)"
                                                :error-messages="modal.erros.categoria" label="Categoria*"
                                                name="categoria" :disabled="modal.method === 'DELETE'"
                                                :rules="[v => !!v || 'Campo obrigatório']"
                                                v-model="modal.form.categoria" item-text="nome" item-value="id">
                                            </v-select>
                                        </v-col>
                                    </v-row>
                                    <v-row v-if="modal.estadoAtual === modal.estadoAlteracaoContato">
                                        <input type="hidden" name="negocio" :value="meuNegocio.id" />
                                        <v-col cols="12" sm="6" md="4">
                                            <v-text-field outlined label="Nome*"
                                                :rules="[v => !!v || 'Campo obrigatório']" name="nome"
                                                :disabled="modal.method === 'DELETE'" :error-messages="modal.erros.nome"
                                                hint="Nome do contato" v-model="modal.form.nome">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <input type="hidden" name="telefone" v-model="modal.form.telefone" />
                                            <v-text-field outlined label="Telefone*"
                                                :rules="[v => !!v || 'Campo obrigatório']"
                                                :error-messages="modal.erros.telefone"
                                                hint="Telefone do contato com código de área, digite apenas números"
                                                :disabled="modal.method === 'DELETE'" v-model="telefoneFormatado">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <v-switch outlined label="Possui Whatsapp?" name="possui_whatsapp"
                                                hint="Pode realizar atendimento via Whatsapp?"
                                                :error-messages="modal.erros.possui_whatsapp"
                                                :disabled="modal.method === 'DELETE'"
                                                v-model="modal.form.possui_whatsapp"
                                                :value="modal.form.possui_whatsapp">
                                            </v-switch>
                                        </v-col>
                                    </v-row>
                                    <v-row v-if="modal.estadoAtual === modal.estadoAlteracaoProduto">
                                        <input type="hidden" name="negocio" :value="meuNegocio.id" />
                                        <v-col cols="12" sm="6" md="4">
                                            <v-text-field outlined label="Nome*"
                                                :rules="[v => !!v || 'Campo obrigatório']" name="nome"
                                                :disabled="modal.method === 'DELETE'" :error-messages="modal.erros.nome"
                                                hint="Nome do produto" v-model="modal.form.nome">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <input type="hidden" name="preco" v-model="modal.form.preco" />
                                            <v-text-field outlined label="Preço" :error-messages="modal.erros.preco"
                                                hint="Preço do produto" prefix="R$"
                                                :disabled="modal.method === 'DELETE'" v-model="precoFormatado"
                                                :value="meuNegocio.taxa_padrao_entrega">
                                            </v-text-field>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <v-select outlined :items="categorias.slice(1)"
                                                :error-messages="modal.erros.categoria" label="Categoria*"
                                                name="categoria" :disabled="modal.method === 'DELETE'"
                                                :rules="[v => !!v || 'Campo obrigatório']"
                                                v-model="modal.form.categoria" item-text="nome" item-value="id">
                                            </v-select>
                                        </v-col>
                                    </v-row>
                                    <v-row v-if="modal.estadoAtual === modal.estadoAlteracaoRegiaoEntrega">
                                        <input type="hidden" name="negocio" :value="meuNegocio.id" />
                                        <v-col cols="12" sm="6" md="4">
                                            <v-select outlined :items="regioesEntrega.slice(1)"
                                                :error-messages="modal.erros.regiao" label="Região*" name="regiao"
                                                :disabled="modal.method === 'DELETE'"
                                                :rules="[v => !!v || 'Campo obrigatório']" v-model="modal.form.regiao"
                                                item-text="nome" item-value="id">
                                            </v-select>
                                        </v-col>
                                        <v-col cols="12" sm="6" md="4">
                                            <input type="hidden" name="taxa_entrega"
                                                v-model="modal.form.taxa_entrega" />
                                            <v-text-field outlined label="Taxa de entrega"
                                                :error-messages="modal.erros.taxa_entrega"
                                                hint="Valor da taxa de entrega para a região" prefix="R$"
                                                :disabled="modal.method === 'DELETE'" v-model="taxa_entregaFormatada"
                                                :value="meuNegocio.taxa_padrao_entrega">
                                            </v-text-field>
                                        </v-col>
                                    </v-row>
                                </v-container>
                            </v-card-text>
                            <v-card-actions>
                                <v-spacer></v-spacer>
                                <v-btn color="blue darken-1" text @click="fecharModalForm()">Cancelar</v-btn>
                                <v-btn type="submit" color="deep-purple lighten-1" :dark="submitHabilitado"
                                    :disabled="!submitHabilitado">
                                    [[ modal.method === 'DELETE' ? 'Excluir' : 'Salvar' ]]
                                </v-btn>
                            </v-card-actions>
                        </v-form>
                    </v-card>
                </v-dialog>
                {% endif %}
            </v-container>
        </v-content>
        <v-footer app color=" lime lighten-2" absolute class="py-0">
            <v-col class="text-center py-1" cols="12">
                <span>Feito por <a href="https://twitter.com/gui_niz">@gui_niz</a></span>
            </v-col>
        </v-footer>
    </v-app>

    {% if PROD %}
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    {% else %}
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    {% endif %}
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // Geral
        const ESTADO_LISTA = 1;
        const ESTADO_DETALHE = 2;
        const ESTADO_ADMINISTRAR = 3;

        // Modal
        const ESTADO_FECHADO = 0;
        const ESTADO_ALTERACAO_NEGOCIO = 1;
        const ESTADO_ALTERACAO_CONTATO = 2;
        const ESTADO_ALTERACAO_REGIAO_ENTREGA = 3;
        const ESTADO_ALTERACAO_PRODUTO = 4;
        const ESTADO_ALTERACAO_CATEGORIA = 5;

        // Categorias
        const CATEGORIA_CONGELADOS = 1;
        const CATEGORIA_SALGADOS = 2;
        const CATEGORIA_DOCES = 3;
        const CATEGORIA_PAES = 4;
        const CATEGORIA_BEBIDAS = 5;
        const CATEGORIA_CASTANHAS = 6;
        const CATEGORIA_CAFES = 7;
        const CATEGORIA_COGUMELOS = 8;
        const CATEGORIA_HORTIFRUTI = 9;
        const CATEGORIA_CARNES = 10;
        const CATEGORIA_PEIXES = 11;
        const CATEGORIA_LATICINIOS = 12;
        const CATEGORIA_MASSAS = 13;
        const CATEGORIA_COMIDA_ASIATICA = 14;
        const CATEGORIA_COMIDA_MEXICANA = 15;
        const CATEGORIA_OVOS = 16;

        const URL_CATEGORIA = '/api/negocios/categorias/';
        const URL_CONTATO = '/api/contatos/';
        const URL_NEGOCIO = '/api/negocios/';
        const URL_REGIAO_ENTREGA = '/api/negocios/regioes-entrega/';
        const URL_PRODUTO = '/api/produtos/';

        {% if request.user.is_authenticated %}
        axios.defaults.xsrfCookieName = 'csrftoken'
        axios.defaults.xsrfHeaderName = "X-CSRFTOKEN"
        {% endif %}

        let app = new Vue({
            el: '#app',
            delimiters: ['[[', ']]'],
            vuetify: new Vuetify({
                lang: {
                    current: 'pt-br',
                },
            }),

            data: {
                drawer: false,
                showFiltros: true,
                modal: {
                    show: false,

                    elementoAlterado: null,
                    erros: {},
                    estadoAtual: ESTADO_FECHADO,
                    estadoAlteracaoNegocio: ESTADO_ALTERACAO_NEGOCIO,
                    estadoAlteracaoCategoria: ESTADO_ALTERACAO_CATEGORIA,
                    estadoAlteracaoContato: ESTADO_ALTERACAO_CONTATO,
                    estadoAlteracaoRegiaoEntrega: ESTADO_ALTERACAO_REGIAO_ENTREGA,
                    estadoAlteracaoProduto: ESTADO_ALTERACAO_PRODUTO,
                    form: {},
                    formValido: false,
                    headline: '',
                    method: '',
                    url: ''
                },

                categorias: [{ id: 0, nome: 'Todas' },],
                negocios: [],
                negocioSelecionado: null,
                meuNegocio: null,
                regioesEntrega: [{ id: 0, nome: 'Todas' },],

                estadoDrawer: true,

                estadoAtual: ESTADO_LISTA,
                estadoLista: ESTADO_LISTA,
                estadoDetalhe: ESTADO_DETALHE,
                estadoAdministrar: ESTADO_ADMINISTRAR,

                pesquisa: {
                    categoria: 0,
                    nome: '',
                    regiaoEntrega: 0,
                },

                loading: [1, 1]
            },

            computed: {
                negociosFiltrados: function () {
                    var lista = [];

                    const nomePesquisa = this.pesquisa.nome.toLowerCase();

                    for (negocio of this.negocios) {
                        if (this.filtrarNegocioCategoria(negocio) && this.filtrarNegocioNome(negocio, nomePesquisa)
                            && this.filtrarNegocioRegiaoEntrega(negocio)) {
                            lista.push(negocio);
                        }
                    }

                    function compare(a, b) {
                        if (a.nome < b.nome)
                            return -1;
                        if (a.nome > b.nome)
                            return 1;
                        return 0;
                    }

                    return lista.sort(compare);
                },
                submitHabilitado: function () {
                    return this.modal.formValido || this.modal.method === 'DELETE';
                },
                precoFormatado: {
                    get: function () {
                        return this.formatarPrecoForm(this.modal.form.preco);
                    },
                    set: function (newValue) {
                        this.modal.form.preco = newValue.replace(/\D/g, '');
                    }
                },
                taxa_entregaFormatada: {
                    get: function () {
                        return this.formatarPrecoForm(this.modal.form.taxa_entrega);
                    },
                    set: function (newValue) {
                        this.modal.form.taxa_entrega = newValue.replace(/\D/g, '');
                    }
                },
                taxa_padrao_entregaFormatada: {
                    get: function () {
                        return this.formatarPrecoForm(this.modal.form.taxa_padrao_entrega);
                    },
                    set: function (newValue) {
                        this.modal.form.taxa_padrao_entrega = newValue.replace(/\D/g, '');
                    }
                },
                telefoneFormatado: {
                    get: function () {
                        return this.formatarTelefone(this.modal.form.telefone);
                    },
                    set: function (newValue) {
                        this.modal.form.telefone = newValue.replace(/\D/g, '');
                    }
                },
                valor_minimoFormatado: {
                    get: function () {
                        return this.formatarPrecoForm(this.modal.form.valor_minimo);
                    },
                    set: function (newValue) {
                        this.modal.form.valor_minimo = newValue.replace(/\D/g, '');
                    }
                }
            },

            methods: {
                buscarCategoriaIcone(categoria_id) {
                    if (!categoria_id) return '';

                    for (categoria of this.categorias) {
                        if (categoria.id === categoria_id) {
                            return categoria.icone;
                        }
                    }
                    return '';
                },
                buscarCategoriaNome(categoria_id) {
                    if (!categoria_id) return '';

                    for (categoria of this.categorias) {
                        if (categoria.id === categoria_id) {
                            return categoria.nome;
                        }
                    }
                    return '';
                },
                filtrarNegocioCategoria(negocio) {
                    if (this.pesquisa.categoria) {
                        for (categoria of negocio.categorias) {
                            if (categoria.id === this.pesquisa.categoria) {
                                return true;
                            }
                        }
                        return false;
                    }
                    return true;
                },
                filtrarNegocioNome(negocio, nomeLowerCase) {
                    return (negocio.nome.toLowerCase().indexOf(nomeLowerCase) > -1);
                },
                filtrarNegocioRegiaoEntrega(negocio) {
                    if (this.pesquisa.regiaoEntrega) {
                        for (regiao_entrega of negocio.regioes_entrega) {
                            if (regiao_entrega.regiao === this.pesquisa.regiaoEntrega) {
                                return true;
                            }
                        }
                        return false;
                    }
                    return true;
                },
                formatarPreco(preco) {
                    if (!preco) return 0;

                    var centavos = String(preco % 100);
                    if (centavos.length < 2) {
                        centavos = "0".concat(centavos);
                    }
                    return `R$ ${Math.floor(preco / 100)},${centavos}`;
                },
                formatarPrecoForm(valor) {
                    valor = valor || 0;
                    valor = Number(String(valor).replace(/\D/g, ''));

                    var centavos = String(valor % 100);
                    if (centavos.length < 2) {
                        centavos = "0".concat(centavos);
                    }
                    return `${Math.floor(valor / 100)},${centavos}`;
                },
                formatarTelefone(telefone) {
                    telefone = telefone || '';

                    if (telefone.length < 8) {
                        return telefone;
                    }

                    const ddd = telefone.substring(0, 2);
                    const parte1 = telefone.substring(2, telefone.length - 4);
                    const parte2 = telefone.substring(telefone.length - 4);
                    return `(${ddd}) ${parte1}-${parte2}`
                },
                formatarFormaEntrega(formasEntrega) {
                    if (!formasEntrega) return null;

                    switch (formasEntrega) {
                        case 1:
                            return 'Delivery';
                        case 2:
                            return 'Take Out';
                        case 3:
                            return 'Delivery e Take Out';
                        default:
                            return null;
                    }
                },
                formatarUrlInstagram(urlInstagram) {
                    // Preparar link instagram
                    if (urlInstagram.length > 0) {
                        return 'https://instagram.com/' + urlInstagram;
                    }
                    return '';
                },
                prepararInfoNegocio(negocio) {
                    for (contato of negocio.contatos) {
                        if (contato.nome.length > 0) {
                            contato.nome_telefone = contato.nome + ' ' + this.formatarTelefone(contato.telefone);
                        } else {
                            contato.nome_telefone = this.formatarTelefone(contato.telefone);
                        }

                        // Preparar link whatsapp
                        if (contato.possui_whatsapp) {
                            contato.whatsapp = "https://wa.me/55" + contato.telefone;
                        }
                    }
                },
                prepararInfoNegocioProdutos(negocio) {
                    this.loading.push(1);
                    axios
                        .get(`${URL_NEGOCIO}${negocio.id}/produtos/`)
                        .then(response => {
                            this.loading.pop();
                            negocio.produtos = response.data;
                        });
                },
                prepararInfoNegocioRegioesEntrega(negocio) {
                    // Definir nomes para regiões de entrega
                    for (regiao_entrega of negocio.regioes_entrega) {
                        for (regiao of this.regioesEntrega) {
                            if (regiao_entrega.regiao === regiao.id) {
                                regiao_entrega.nomeRegiao = regiao.nome;
                                break;
                            }
                        }
                    }
                },
                selecionarNegocio(negocio) {
                    this.negocioSelecionado = negocio;
                    this.negocioSelecionado.produtos = [];
                    this.estadoAtual = this.estadoDetalhe;

                    this.prepararInfoNegocioProdutos(this.negocioSelecionado)

                    this.prepararInfoNegocioRegioesEntrega(this.negocioSelecionado);
                },
                voltarLista() {
                    this.negocioSelecionado = null;
                    this.estadoAtual = this.estadoLista;
                },

                //{% if request.user.is_authenticated %}
                // Modal
                enviarForm(event) {
                    let formData = new FormData(event.target);

                    this.loading.push(1);
                    if (this.modal.method === 'POST') {
                        axios
                            .post(this.modal.url, formData)
                            .then(response => {
                                app.loading.pop();
                                // Preencher negócio
                                if (app.modal.estadoAtual === ESTADO_ALTERACAO_NEGOCIO) {
                                    app.meuNegocio = response.data;
                                    app.meuNegocio.produtos = [];
                                }
                                app.modal.elementoAlterado.push(response.data);

                                // Atualizar
                                app.prepararInfoNegocio(app.meuNegocio);
                                app.prepararInfoNegocioRegioesEntrega(app.meuNegocio);
                                app.fecharModalForm();
                            })
                            .catch(function (error) {
                                app.loading.pop();
                                for (const propriedade in error.response.data) {
                                    app.modal.erros = error.response.data;
                                }
                            });
                    } else if (this.modal.method === 'PUT') {
                        axios
                            .put(this.modal.url, formData)
                            .then(response => {
                                app.loading.pop();
                                app.modal.elementoAlterado = Object.assign(app.modal.elementoAlterado, response.data);

                                // Atualizar
                                app.prepararInfoNegocio(app.meuNegocio);
                                app.prepararInfoNegocioRegioesEntrega(app.meuNegocio);
                                app.fecharModalForm();
                            })
                            .catch(function (error) {
                                app.loading.pop();
                                for (const propriedade in error.response.data) {
                                    app.modal.erros = error.response.data;
                                }
                            });
                    } else if (this.modal.method === 'DELETE') {
                        axios
                            .delete(this.modal.url, formData)
                            .then(response => {
                                app.loading.pop();
                                if (app.modal.elementoAlterado) {
                                    for (var i = 0; i < app.modal.elementoAlterado.length; i++) {
                                        if (app.modal.url.indexOf(app.modal.elementoAlterado[i].id)) {
                                            app.modal.elementoAlterado.splice(i, 1);
                                            break;
                                        }
                                    }
                                }
                                app.fecharModalForm();
                            })
                            .catch(function (error) {
                                app.loading.pop();
                            });
                    }
                },
                mostrarModalForm(tipo_objeto, objeto, apagar) {
                    this.modal.method = (objeto === null ? 'POST' : (apagar ? 'DELETE' : 'PUT'));
                    switch (tipo_objeto) {
                        case 'categoria':
                            this.modal.headline = (apagar ? 'Deseja realmente excluir a seguinte Categoria?' : 'Categoria');
                            this.modal.estadoAtual = this.modal.estadoAlteracaoCategoria;
                            this.modal.url = (objeto == null ? URL_CATEGORIA : `${URL_CATEGORIA}${objeto.id}/`);
                            this.modal.elementoAlterado = (objeto && !apagar ? objeto : this.meuNegocio.categorias);
                            break;
                        case 'contato':
                            this.modal.headline = (apagar ? 'Deseja realmente excluir o seguinte Contato?' : 'Contato');
                            this.modal.estadoAtual = this.modal.estadoAlteracaoContato;
                            this.modal.url = (objeto == null ? URL_CONTATO : `${URL_CONTATO}${objeto.id}/`);
                            this.modal.elementoAlterado = (objeto && !apagar ? objeto : this.meuNegocio.contatos);
                            break;
                        case 'negocio':
                            this.modal.headline = (apagar ? 'Deseja realmente excluir o seguinte Negócio?' : 'Negócio');
                            this.modal.estadoAtual = this.modal.estadoAlteracaoNegocio;
                            this.modal.url = (objeto == null ? URL_NEGOCIO : `${URL_NEGOCIO}${objeto.id}/`);
                            this.modal.elementoAlterado = (objeto && !apagar ? objeto : this.negocios);
                            break;
                        case 'produto':
                            this.modal.headline = (apagar ? 'Deseja realmente excluir o seguinte Produto?' : 'Produto');
                            this.modal.estadoAtual = this.modal.estadoAlteracaoProduto;
                            this.modal.url = (objeto == null ? URL_PRODUTO : `${URL_PRODUTO}${objeto.id}/`);
                            this.modal.elementoAlterado = (objeto && !apagar ? objeto : this.meuNegocio.produtos);
                            break;
                        case 'regiao-entrega':
                            this.modal.headline = (apagar ? 'Deseja realmente excluir a seguinte Região de entrega?' : 'Região de entrega');
                            this.modal.estadoAtual = this.modal.estadoAlteracaoRegiaoEntrega;
                            this.modal.url = (objeto == null ? URL_REGIAO_ENTREGA : `${URL_REGIAO_ENTREGA}${objeto.id}/`);
                            this.modal.elementoAlterado = (objeto && !apagar ? objeto : this.meuNegocio.regioes_entrega);

                            if (this.modal.method === 'POST') this.modal.form.taxa_entrega = this.meuNegocio.taxa_padrao_entrega;
                            break;
                    }

                    if (objeto !== null) {
                        this.modal.form = { ...objeto };
                    }
                    this.modal.show = true;
                },
                fecharModalForm() {
                    const padraoModal = {
                        show: false,
                        elementoAlterado: null,
                        erros: {},
                        estadoAtual: ESTADO_FECHADO,
                        form: {},
                        formValido: false,
                        headline: '',
                        method: '',
                        url: ''
                    };
                    this.modal = {
                        ...this.modal, ...padraoModal
                    };
                },
                //{% endif %}

                // Drawer
                irParaPesquisa() {
                    this.estadoAtual = (this.negocioSelecionado ? this.estadoDetalhe : this.estadoLista);
                    this.meuNegocio = null;
                    this.drawer = false;
                },
                irParaAdministracao() {
                    this.loading.push(1);
                    axios
                        .get('/api/negocios/meus/')
                        .then(response => {
                            app.loading.pop();
                            if (response.data.length > 0) {
                                for (negocio of app.negocios) {
                                    if (negocio.id === response.data[0].id) {
                                        this.meuNegocio = negocio;

                                        // Buscar produtos
                                        this.prepararInfoNegocioProdutos(this.meuNegocio);
                                        // Definir nomes para regiões de entrega
                                        this.prepararInfoNegocioRegioesEntrega(this.meuNegocio);
                                        break;
                                    }
                                }
                            }
                            this.estadoAtual = this.estadoAdministrar;
                        });

                    this.drawer = false;
                }
            },

            mounted() {
                axios
                    .get('/api/negocios/')
                    .then(response => {
                        app.loading.pop();
                        this.negocios = response.data;
                        for (negocio of this.negocios) {
                            app.prepararInfoNegocio(negocio);
                        }
                    });
                axios
                    .get('/api/categorias/')
                    .then(response => {
                        app.loading.pop();
                        this.categorias.push(...response.data);
                        for (categoria of this.categorias) {

                            switch (categoria.id) {
                                case CATEGORIA_CONGELADOS:
                                    categoria.icone = 'mdi-snowflake';
                                    break;
                                case CATEGORIA_SALGADOS:
                                    categoria.icone = 'mdi-food-fork-drink';
                                    break;
                                case CATEGORIA_DOCES:
                                    categoria.icone = 'mdi-cupcake';
                                    break;
                                case CATEGORIA_PAES:
                                    categoria.icone = 'mdi-storefront';
                                    break;
                                case CATEGORIA_BEBIDAS:
                                    categoria.icone = 'mdi-cup-water';
                                    break;
                                case CATEGORIA_CASTANHAS:
                                    categoria.icone = 'mdi-peanut-outline';
                                    break;
                                case CATEGORIA_CAFES:
                                    categoria.icone = 'mdi-coffee';
                                    break;
                                case CATEGORIA_COGUMELOS:
                                    categoria.icone = 'mdi-mushroom';
                                    break;
                                case CATEGORIA_HORTIFRUTI:
                                    categoria.icone = 'mdi-flower';
                                    break;
                                case CATEGORIA_CARNES:
                                    categoria.icone = 'mdi-silverware-fork-knife';
                                    break;
                                case CATEGORIA_PEIXES:
                                    categoria.icone = 'mdi-fish';
                                    break;
                                case CATEGORIA_LATICINIOS:
                                    categoria.icone = 'mdi-cow';
                                    break;
                                case CATEGORIA_MASSAS:
                                    categoria.icone = 'mdi-pasta';
                                    break;
                                case CATEGORIA_COMIDA_ASIATICA:
                                    categoria.icone = 'mdi-noodles';
                                    break;
                                case CATEGORIA_COMIDA_MEXICANA:
                                    categoria.icone = 'mdi-fire';
                                    break;
                                case CATEGORIA_OVOS:
                                    categoria.icone = 'mdi-egg-outline';
                                    break;
                            }
                        }
                    });
                axios
                    .get('/api/regioes-entrega/')
                    .then(response => {
                        this.regioesEntrega.push(...response.data);
                    });
            }
        })
    </script>
</body>

</html>